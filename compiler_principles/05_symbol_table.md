# 符号表

## 常见属性

- 名字
- 类别（常量/变量/函数）
- 类型（数据类型）
- 储存类别和储存分配信息（存在什么区，分配多大，基址偏移）
- 作用域、可见性

## 作用域和可见性

- 作用域：拥有共同有效范围的符号所在的程序单元
- 关系：嵌套/不相交
- 当前作用域
- 开作用域：当前作用域和嵌套的所有作用域
  - （=活跃的作用域）
- 闭作用域：不属于开作用域
- 可见性：在特定点，哪些符号可访问
- 可见性规则：
  - 开作用域中声明的符号才可访问
  - 多个开作用域中都有该符号，取最近的
  - 新的声明只存在于当前作用域
- 多符号表组织：每个作用域一个符号表
- 单符号表组织：所有嵌套的作用域共用一个全局符号表

### 单符号表组织

每个作用域对应一个作用域号，符号属性也记录作用域号，开变成闭作用域时删除该作用域中的符号

#### 一般的表示法

val/level表示自己在哪一层，addr仅对变量有效，其中DX表示该过程基址；size仅对过程有效，CX表示过程活动记录中**控制单元的数目**，还要加上局部变量数目才是size

| name | kind      | val/level | addr | size |
| ---- | --------- | --------- | ---- | ---- |
| a    | const     | 25        |      |      |
| x    | var       | 1         | DX   |      |
| y    | var       | 1         | DX+1 |      |
| p    | procedure | 1         |      | CX+1 |

### 多符号表组织

每个作用域有各自的符号表，需要维护一个作用域栈

